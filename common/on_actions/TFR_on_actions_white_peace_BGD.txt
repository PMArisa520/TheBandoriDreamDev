on_actions = {
	on_capitulation = {
		effect = {
			log = "[GetDateText]: FROM: [From.GetName] ROOT: [Root.GetName] on_capitulation"
			set_global_flag = show_peace_popup_alert
			FROM = {
				save_global_event_target_as = winning_country
			}
			ROOT = {
				save_global_event_target_as = losing_country
			}
			log = "[GetDateText]: winner/loser: FROM: [winning_country.GetName] ROOT: [losing_country.GetName] on_capitulation"
			if = {
				limit = {
					event_target:losing_country = {
						any_allied_country = {
							has_war_together_with = event_target:losing_country
						}
					}
				}
				set_global_flag = losing_country_multiple
			}
			if = {
				limit = {
					event_target:winning_country = {
						any_allied_country = {
							has_war_together_with = event_target:winning_country
						}
					}
				}
				set_global_flag = winning_country_multiple
			}
			if = {
				# FPR kill CYP
				limit = {
					FROM = {
						OR = {
							original_tag = BGD
							is_ally_with = BGD
						}
					}
					ROOT = {
						original_tag = USB
						original_tag = USC
						original_tag = APA
						original_tag = ATW
						original_tag = PTF
						original_tag = NSM
					}
				}
				ROOT = {
					dismantle_faction = yes
					leave_faction = yes
				}
				FROM = {
					white_peace = ROOT
					USN = {
						annex_country = {
							target = ROOT
							transfer_troops = no
						}
					}
				}
				set_global_flag = skip_default_capitulation
			}
			if = {
				#赛里斯打死东南亚三宝直接吞并
				limit = {
					FROM = {
						#OR = {
						#	original_tag = PRC
						#	#PRC = {
						#	#	has_cosmetic_tag  = PRC_dongyaguo
						#	#}
						#}
						original_tag = PRC
					}
					ROOT = {
						OR = {
							original_tag = LAO
							original_tag = VIN
							original_tag = CAM
						}
					}
				}
				ROOT = {
					dismantle_faction = yes
					leave_faction = yes
				}
				FROM = {
					white_peace = ROOT
					ROOT = {
						every_controlled_state = {
							add_core_of = FROM
							remove_core_of = ROOT
						}
					}
					PRC = {
						annex_country = {
							target = ROOT
							transfer_troops = no
						}
					}
				}
				set_global_flag = skip_default_capitulation
			}

			if = {
				# Students Kill SIA
				limit = {
					FROM = {
						OR = {
							original_tag = ETI
						}
					}
					ROOT = {
						original_tag = SIA
					}
				}
				SIA = {
					transfer_navy = {
						target = ETI
					}
				}
				ETI = {
					white_peace = FROM
					set_cosmetic_tag = ETI_republic_of_siam
					annex_country = {
						target = SIA
						transfer_troops = yes
					}
					every_state = {
						limit = {
							is_core_of = SIA
						}
						remove_core_of = SIA
						remove_dynamic_modifier = { modifier = BRM_peoples_war }
					}
					remove_ideas_with_trait = ZZZ_blank_idea_trait
					set_popularities = {
						social_democrat = 50
						social_liberal = 5
						libertarian_socialist = 5
						communist = 25
						market_liberal = 5
						conservative = 5
						authoritarian_democrat = 5
					}
					set_politics = {
						ruling_party = social_democrat
						elections_allowed = yes
						election_frequency = 48
					}
					#create_country_leader = {
					#	name = "BGD_Mana"
					#	desc = "BGD_Mana_DESC"
					#	picture = GFX_portrait_Mana
					#	ideology = kirakira_dokidoki
					#	traits = {}
					#}
				}
				BGD = {
					country_event = {
						id = bgd.110
						days = 3
					}
				}
			}
			if = {
				# APFNO and Thai's Students Kill SIA
				limit = {
					FROM = {
						OR = {
							original_tag = BGD
							has_country_flag = APFNO_member
						}
					}
					ROOT = {
						original_tag = SIA
					}
				}
				SIA = {
					transfer_navy = {
						target = ETI
					}
				}
				ETI = {
					white_peace = SIA
					set_cosmetic_tag = ETI_republic_of_siam
					annex_country = {
						target = SIA
						transfer_troops = yes
					}
					every_state = {
						limit = {
							is_core_of = SIA
						}
						remove_core_of = SIA
						remove_dynamic_modifier = { modifier = BRM_peoples_war }
					}
					every_state = {
    				    limit = {
    				        is_core_of = ETI
    				    }
    				    transfer_state_to = ETI
    				}
					remove_ideas_with_trait = ZZZ_blank_idea_trait
					set_popularities = {
						social_democrat = 50
						social_liberal = 5
						libertarian_socialist = 5
						communist = 25
						market_liberal = 5
						conservative = 5
						authoritarian_democrat = 5
					}
					set_politics = {
						ruling_party = social_democrat
						elections_allowed = yes
						election_frequency = 48
					}
					#create_country_leader = {
					#	name = "BGD_Mana"
					#	desc = "BGD_Mana_DESC"
					#	picture = GFX_portrait_Mana
					#	ideology = kirakira_dokidoki
					#	traits = {}
					#}
				}
				BGD = {
					country_event = {
						id = bgd.110
						days = 3
					}
				}
			}


			if = {
				# APFNO Kill USA
				limit = {
					FROM = {
						has_country_flag = APFNO_member
					}
					ROOT = {
						has_country_flag = USA_battle_for_america_idea
					}
				}
				USN = {
					annex_country = {
						target = ROOT
					}
				}
			}

			if = {
				# APFNO Kill APLA
				limit = {
					FROM = {
						OR = {
							has_country_flag = APFNO_member
							original_tag = BGD
						}
					}
					ROOT = {
						original_tag = APA
					}
				}
				USN = {
					annex_country = {
						target = APA
					}
				}
				if = {
					limit = {
						NNN = { exists = yes }
						APA = { is_in_faction_with = NNN }
					}
					USN = {
						annex_country = {
							target = NNN
						}
					}
				}
			}

			if = {
				# PRC Kill CHI
				limit = {
					FROM = {
						OR = {
							original_tag = PRC
						}
					}
					ROOT = {
						original_tag = CHI
					}
				}
				CHI = {
					transfer_navy = {
						target = PRC
					}
				}
				PRC = {
					white_peace = CHI
					annex_country = {
						target = CHI
						transfer_troops = yes
					}
					every_state = {
						limit = {
							is_core_of = CHI
						}
						remove_core_of = CHI
					}
					every_state = {
    				    limit = {
    				        is_core_of = CHI
    				    }
    				    transfer_state_to = CHI
    				}
					country_event = {
						id = bgd.1984
					}
				}
			}

			#BGD Kill East African
			if = {
				limit = {
					FROM = {
						original_tag = BGD
					}
					ROOT = {
						original_tag = TZN
					}
				}
				BGD = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = UA4
							autonomy_state = bgd_allied_countries_state
						}
					}
					else = {
						puppet = UA4
					}
				}
				UA4 = {
					transfer_state = 550
					transfer_state = 867
					transfer_state = 268
					transfer_state = 1140
					transfer_state = 271
					transfer_state = 1141
					transfer_state = 1297
					transfer_state = 674
					transfer_state = 866
					transfer_state = 955
					transfer_state = 559
					transfer_state = 807
					transfer_state = 269
					transfer_state = 762
					transfer_state = 1351
					transfer_state = 1344
					transfer_state = 1445
					transfer_state = 1348
					transfer_state = 548
					transfer_state = 1353
					transfer_state = 1352
					transfer_state = 547
					transfer_state = 1354
					transfer_state = 781
					transfer_state = 780
					transfer_state = 546
					transfer_state = 544
					transfer_state = 820
					transfer_state = 543
					transfer_state = 1345
					transfer_state = 1295
					transfer_state = 708
					set_cosmetic_tag = UA_Military_Gov
					create_country_leader = {
						name = "BGD_APFNO_LEADER"
						desc = "BGD_APFNO_LEADER_DESC"
						picture = GFX_portrait_AU_MIL
						ideology = kirakira_dokidoki
						traits = {
							rebuild_gov
						}
					}
					set_party_name = {
						ideology = social_democrat
						long_name = EastAfrica_social_democrat_long
						name = EastAfrica_social_democrat
					}
				
					set_politics = {
						  ruling_party = social_democrat
						  elections_allowed = no
					}
					add_popularity = {
						  ideology = social_democrat
						  popularity = 1
					}
					set_capital = {
						state = 547
					}
				}
				set_global_flag = skip_default_capitulation
			}
		}
	}
}



on_actions = {
	on_capitulation_immediate = {#立刻执行#
		effect = {
			log = "[GetDateText]: FROM: [From.GetName] ROOT: [Root.GetName] on_capitulation"
			set_global_flag = show_peace_popup_alert
			FROM = {
				save_global_event_target_as = winning_country
			}
			ROOT = {
				save_global_event_target_as = losing_country
			}
			log = "[GetDateText]: winner/loser: FROM: [winning_country.GetName] ROOT: [losing_country.GetName] on_capitulation"
			if = {
				limit = {
					event_target:losing_country = {
						any_allied_country = {
							has_war_together_with = event_target:losing_country
						}
					}
				}
				set_global_flag = losing_country_multiple
			}
			if = {
				limit = {
					event_target:winning_country = {
						any_allied_country = {
							has_war_together_with = event_target:winning_country
						}
					}
				}
				set_global_flag = winning_country_multiple
			}
			#BGD Kill World
			if = {
				limit = {
					FROM = {
						OR = {
							original_tag = BGD
							is_ally_with = BGD
						}
					}
					ROOT = {
						OR = {
							NOT = {
								original_tag = BGD
							}
							NOT = {
								is_ally_with = BGD
							}
						}
					}
				}
				if = {
					limit = {
						ROOT = {
							has_idea = african_union_member
						}
					}
					log = "Kasumi Fucking African!!! KILL [Root.GetName]"
					ROOT = {
						white_peace = FROM
						ASIA_MIL_GOV_EFF = yes
					}
					FROM = {
						#white_peace = ROOT
						set_autonomy = {
							target = ROOT
							autonomy_state = bgd_allied_countries_state
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
						ROOT = {
							has_idea = USA_battle_for_america_idea
						}
					}
					USN = {
						annex_country = {
							target = ROOT
						}
						every_owned_state = {
							limit = { controller = { tag = USN } }
							add_core_of = USN
						}
					}
					log = "Kasumi Fucking American @USA!!! KILL [Root.GetName]"
				}
				else_if = {
					# ASIAN Kill HRL
					limit = {
						BGD = { has_cosmetic_tag = BGD_united_asia }
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
						ROOT = {
							original_tag = HRL
						}
					}
					log = "Kasumi Fucking NORTH AFRICAN @HRL!!! KILL [Root.GetName]"
					FROM = {
						white_peace = ROOT
						MOR = {
							transfer_state = 290
							transfer_state = 461
							transfer_state = 462
							transfer_state = 699
							transfer_state = 882
							ASIA_MIL_GOV_EFF = yes
						}
						ALG = {
							transfer_state = 514
							transfer_state = 513
							transfer_state = 459
							transfer_state = 460
							transfer_state = 1331
							ASIA_MIL_GOV_EFF = yes
						}
						TUN = {
							transfer_state = 665
							transfer_state = 458
							ASIA_MIL_GOV_EFF = yes
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = MOR
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = MOR
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = ALG
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = ALG
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = TUN
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = TUN
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = ROOT
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = ROOT
						}
					}
					ROOT = {
						white_peace = FROM
						ASIA_MIL_GOV_EFF = yes
					}
				}
				else_if = {
					# ASIAN Kill MLI
					limit = {
						BGD = { has_cosmetic_tag = BGD_united_asia }
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
						ROOT = {
							original_tag = MLI
						}
					}
					log = "Kasumi Fucking WEST AFRICAN @MLI!!! KILL [Root.GetName]"
					FROM = {
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = ROOT
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = ROOT
						}
						VOL = {
							transfer_state = 750
							transfer_state = 751
							ASIA_MIL_GOV_EFF = yes
						}
						NGR = {
							transfer_state = 749
							transfer_state = 748
							transfer_state = 747
							ASIA_MIL_GOV_EFF = yes
						}
						BIA = {
							transfer_state = 764
							ASIA_MIL_GOV_EFF = yes
						}
						GNA = {
							transfer_state = 775
							transfer_state = 774
							ASIA_MIL_GOV_EFF = yes
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = VOL
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = VOL
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = NGR
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = NGR
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = BIA
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = BIA
						}
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = GNA
								autonomy_state = bgd_allied_countries_state
							}
						}
						else = {
							puppet = GNA
						}
					}
					ROOT = {
						white_peace = FROM
						ASIA_MIL_GOV_EFF = yes
					}
					every_country = {
						limit = {
							has_country_flag = West_African_Nations
						}
						white_peace = BGD
						ASIA_MIL_GOV_EFF = yes
						clr_country_flag = West_African_Nations
						BGD = {
							if = {
								limit = {
									has_dlc = "Together for Victory"
								}
								set_autonomy = {
									target = PREV
									autonomy_state = bgd_allied_countries_state
								}
							}
							else = {
								puppet = PREV
							}
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
						ROOT = {
							OR = {
								original_tag = ZAP
								original_tag = SIN
								original_tag = GUC
								original_tag = CAS
							}
						}
					}
					ROOT = {
						white_peace = FROM
						white_peace = MEX
					}
					MEX = {
						annex_country = {
							target = ROOT
						}
					}
				}
				else_if = {
					limit = {
						BGD = { has_cosmetic_tag = unrestricted_diplomacy_flag }
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
					}
					ROOT = {
						white_peace = FROM
						ASIA_MIL_GOV_EFF = yes
					}
					FROM = {
						#white_peace = ROOT
						set_autonomy = {
							target = ROOT
							autonomy_state = bgd_allied_countries_state
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							OR = {
								original_tag = BGD
								is_ally_with = BGD
							}
						}
					}
					log = "KIRAKIRA"
					BGD = {
						annex_country = {
							target = ROOT
						}
					}
				}
				set_global_flag = skip_default_capitulation
			}
		}
	}
}


on_actions = {
	on_daily = {
		effect = {
			if = {
				limit = {
					has_cosmetic_tag = UA_Military_Gov
					OR = {
						has_idea_with_trait = ZZZ_blank_idea_trait
						NOT = {
							has_government = social_democrat
						}
					}
				}
				log = "1231"
				remove_ideas_with_trait = ZZZ_blank_idea_trait
				set_politics = {
					ruling_party = social_democrat
					elections_allowed = no
				}
			}
		}
	}
}





















if = {
	#ksm乱杀老美
	limit = {
		FROM= {
			OR = {
				original_tag = BGD
				is_ally_with = BGD
			}
		}
		ROOT = {
			original_tag = USB
			original_tag = USC
			original_tag = APA
			original_tag = ATW
			original_tag = PTF
			original_tag = NSM
		}
	}
	FROM = {
		white_peace = ROOT
		USN = {
			annex_country = {
				tag = ROOT
				transfer_troops = no
			}
		}
	}
	set_global_flag = skip_default_capitulation
}
